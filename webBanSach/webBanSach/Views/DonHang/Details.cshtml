@model webBanSach.ViewModels.DonHangViewModel

<h2 class="mb-4 fw-bold">Chi tiết đơn hàng #@Model.MaDH</h2>

<div class="card shadow-sm rounded-3">
    <div class="card-body">
        <p><strong>Người nhận:</strong> @Model.HoTen</p>
        <p><strong>Email:</strong> @Model.Email</p>
        <p><strong>SĐT:</strong> @Model.SDT</p>
        <p><strong>Ngày đặt:</strong> @Model.NgayDat.ToString("dd/MM/yyyy HH:mm")</p>
        <p><strong>Địa chỉ giao hàng:</strong> @Model.DiaChiGiao</p>
        <p>
            <strong>Trạng thái:</strong>
            <span class="badge
                @(Model.TrangThai == "Chờ xử lý" ? "bg-warning text-dark" :
                  Model.TrangThai == "Đang giao" ? "bg-info text-dark" :
                  Model.TrangThai == "Hoàn tất" ? "bg-success" : "bg-danger")">
                @Model.TrangThai
            </span>
        </p>

        <hr />

        <h5 class="fw-bold">Danh sách sản phẩm</h5>
        <table class="table table-bordered align-middle">
            <thead class="table-light">
                <tr>
                    <th>Sách</th>
                    <th>Số lượng</th>
                    <th>Đơn giá</th>
                    <th>Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var ct in Model.ChiTiet)
                {
                    <tr>
                        <td>@ct.MaSachNavigation.TenSach</td>
                        <td>@ct.SoLuong</td>
                        <td>@ct.DonGia.ToString("N0") VNĐ</td>
                        <td>@(ct.SoLuong * ct.DonGia).ToString("N0") VNĐ</td>
                    </tr>
                }
            </tbody>
        </table>

        <hr />

        @* Hiển thị tổng tiền gốc và sau giảm *@
        @if (Model.TongTienSauGiam < Model.TongTien)
        {
            <p>
                <strong>Tổng tiền:</strong><br />
                <span style="text-decoration:line-through; color:gray;">
                    @Model.TongTien.ToString("N0") VNĐ
                </span><br />
                <span style="color:red; font-weight:bold;">
                    @Model.TongTienSauGiam.ToString("N0") VNĐ
                </span>
            </p>
        }
        else
        {
            <p>
                <strong>Tổng tiền:</strong>
                <span class="text-danger fw-bold">
                    @Model.TongTien.ToString("N0") VNĐ
                </span>
            </p>
        }
    </div>
</div>

<div class="mt-3">
    <a asp-action="Index" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Quay lại danh sách
    </a>
</div>
