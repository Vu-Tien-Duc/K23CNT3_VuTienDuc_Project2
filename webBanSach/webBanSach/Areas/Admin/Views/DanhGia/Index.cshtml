@model IEnumerable<webBanSach.Models.DanhGia>
@{
    ViewData["Title"] = "Quản lý Bình luận & Đánh giá";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h3><i class="fa-solid fa-comment-dots"></i> Quản lý Bình luận & Đánh giá</h3>

    <form method="get" class="d-flex">
        <input type="text" name="search" class="form-control me-2" placeholder="Tìm theo user hoặc sách..." value="@Context.Request.Query["search"]" />
        <button type="submit" class="btn btn-primary"><i class="fa fa-search"></i></button>
    </form>
</div>

<table class="table table-striped align-middle">
    <thead class="table-dark">
        <tr>
            <th>Người dùng</th>
            <th>Sách</th>
            <th>Ngày</th>
            <th>Đánh giá</th>
            <th>Bình luận</th>
            <th class="text-end">Hành động</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var dg in Model)
        {
            <tr>
                <td>@dg.MaNDNavigation?.HoTen</td>
                <td>@dg.MaSachNavigation?.TenSach</td>
                <td>@dg.NgayDG?.ToString("dd/MM/yyyy")</td>
                <td>
                    @for (int i = 1; i <= 5; i++)
                    {
                        if (i <= dg.Diem)
                        {
                            <i class="fa-solid fa-star text-warning"></i>
                        }
                        else
                        {
                            <i class="fa-regular fa-star text-muted"></i>
                        }
                    }
                </td>
                <td>@dg.BinhLuan</td>
                <td class="text-end">
                    <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal-@dg.MaDG">
                        <i class="fa-solid fa-trash"></i> Xóa
                    </button>

                    <!-- Modal Xóa -->
                    <div class="modal fade" id="deleteModal-@dg.MaDG" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header bg-danger text-white">
                                    <h5 class="modal-title">Xác nhận xóa</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    Bạn có chắc chắn muốn xóa bình luận của <b>@dg.MaNDNavigation?.HoTen</b> về sách <b>@dg.MaSachNavigation?.TenSach</b>?
                                </div>
                                <div class="modal-footer">
                                    <form asp-action="DeleteConfirmed" method="post">
                                        <input type="hidden" name="id" value="@dg.MaDG" />
                                        <button type="submit" class="btn btn-danger">Xóa</button>
                                    </form>
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Hủy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>
